<template>
	<lightning-card title="Test Data Generator" icon-name="utility:database">
		<div class="slds-p-horizontal_medium slds-p-bottom_medium">
			<!-- Current Data Statistics -->
			<div class="slds-box slds-box_small slds-m-bottom_medium">
				<h3 class="slds-text-heading_small slds-m-bottom_small">Current Data Statistics</h3>
				<div class="slds-grid slds-wrap slds-gutters_small">
					<div class="slds-col slds-size_1-of-2 slds-medium-size_1-of-3">
						<div class="slds-text-align_center">
							<div class="slds-text-heading_medium slds-text-color_success">
								{statistics.totalCustomers}
							</div>
							<div class="slds-text-body_small">Total Customers</div>
						</div>
					</div>
					<div class="slds-col slds-size_1-of-2 slds-medium-size_1-of-3">
						<div class="slds-text-align_center">
							<div class="slds-text-heading_medium slds-text-color_warning">
								{statistics.pendingMatches}
							</div>
							<div class="slds-text-body_small">Pending Matches</div>
						</div>
					</div>
					<div class="slds-col slds-size_1-of-2 slds-medium-size_1-of-3">
						<div class="slds-text-align_center">
							<div class="slds-text-heading_medium slds-text-color_default">
								{statistics.mergedMatches}
							</div>
							<div class="slds-text-body_small">Merged Matches</div>
						</div>
					</div>
					<div class="slds-col slds-size_1-of-2 slds-medium-size_1-of-3">
						<div class="slds-text-align_center">
							<div class="slds-text-heading_medium slds-text-color_default">
								{statistics.ignoredMatches}
							</div>
							<div class="slds-text-body_small">Ignored Matches</div>
						</div>
					</div>
					<div class="slds-col slds-size_1-of-2 slds-medium-size_1-of-3">
						<div class="slds-text-align_center">
							<div class="slds-text-heading_medium slds-text-color_error">
								{statistics.mergedCustomers}
							</div>
							<div class="slds-text-body_small">Merged Customers</div>
						</div>
					</div>
				</div>
				<div class="slds-m-top_small">
					<lightning-button
						label="Refresh Statistics"
						onclick={refreshStatistics}
						variant="neutral"
						size="small"
					>
					</lightning-button>
				</div>
			</div>

			<!-- Test Data Generation Section -->
			<div class="slds-box slds-box_small slds-m-bottom_medium">
				<h3 class="slds-text-heading_small slds-m-bottom_small">Generate Test Data</h3>
				<p class="slds-text-body_regular slds-m-bottom_medium">
					Creates comprehensive test customer data including various duplicate scenarios:
				</p>

				<ul class="slds-list_dotted slds-m-bottom_medium">
					<li><strong>Exact Email Duplicates</strong> - Same email addresses (Score: 100)</li>
					<li><strong>Phone + Name Similarity</strong> - Same phone with similar names (Score: 70)</li>
					<li><strong>Phone + Last Name</strong> - Same phone with exact last name (Score: 50)</li>
					<li><strong>Unique Customers</strong> - Clean records with no duplicates</li>
					<li><strong>Edge Cases</strong> - Missing fields and special characters</li>
				</ul>

				<div class="slds-grid slds-gutters_small">
					<div class="slds-col">
						<lightning-button
							label="Generate Test Data"
							onclick={generateTestData}
							variant="brand"
							disabled={isLoading}
						>
						</lightning-button>
					</div>
					<div class="slds-col">
						<lightning-button
							label="Run Duplicate Scan"
							onclick={runDuplicateScan}
							variant="success"
							disabled={isLoading}
						>
						</lightning-button>
					</div>
				</div>
			</div>

			<!-- Data Management Section -->
			<div class="slds-box slds-box_small slds-m-bottom_medium">
				<h3 class="slds-text-heading_small slds-m-bottom_small">Data Management</h3>
				<p class="slds-text-body_regular slds-m-bottom_medium">
					<lightning-icon
						icon-name="utility:warning"
						size="x-small"
						class="slds-m-right_x-small"
					></lightning-icon>
					<strong>Warning:</strong> Clear All Data will permanently delete ALL customer and duplicate match
					records.
				</p>

				<lightning-button
					label="Clear All Data"
					onclick={clearAllData}
					variant="destructive"
					disabled={isLoading}
				>
				</lightning-button>
			</div>

			<!-- Loading Spinner -->
			<template if:true={isLoading}>
				<div class="slds-is-relative">
					<lightning-spinner alternative-text="Processing..." size="medium"></lightning-spinner>
				</div>
			</template>

			<!-- Success/Error Messages -->
			<template if:true={showMessage}>
				<div class={messageVariant} role="alert">
					<span class="slds-assistive-text">{messageType}</span>
					<h2>{messageTitle}</h2>
					<p>{messageText}</p>
					<template if:true={hasErrors}>
						<ul class="slds-list_dotted slds-m-top_small">
							<template for:each={errors} for:item="error">
								<li key={error}>{error}</li>
							</template>
						</ul>
					</template>
					<div class="slds-m-top_small">
						<lightning-button label="Dismiss" onclick={dismissMessage} variant="neutral" size="small">
						</lightning-button>
					</div>
				</div>
			</template>
		</div>
	</lightning-card>
</template>
